<!-- Generated by pkgdown: do not edit by hand -->
<!DOCTYPE html>
<html lang="en">
  <head>
  <meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>Runs a principal components analysis, the facile way. — compare.FacilePcaAnalysisResult • FacileAnalysis</title>


<!-- jquery -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script>
<!-- Bootstrap -->

<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous" />

<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script>

<!-- bootstrap-toc -->
<link rel="stylesheet" href="../bootstrap-toc.css">
<script src="../bootstrap-toc.js"></script>

<!-- Font Awesome icons -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous" />
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous" />

<!-- clipboard.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script>

<!-- headroom.js -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script>

<!-- pkgdown -->
<link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script>



  <link href="../extra.css" rel="stylesheet">
  

<meta property="og:title" content="Runs a principal components analysis, the facile way. — compare.FacilePcaAnalysisResult" />
<meta property="og:description" content="Performs a principal components analysis over a specified assay from the
(subset of) samples in a FacileDataStore." />




<!-- mathjax -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script>

<!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->



  </head>

  <body data-spy="scroll" data-target="#toc">
    <div class="container template-reference-topic">
      <header>
      <div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">FacileAnalysis</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.98.11</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
        <li>
  <a href="../index.html">
    <span class="fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
    <li>
      <a href="../articles/FacileAnalysis-RNAseq.html">RNA-seq Analysis: The Facile Way</a>
    </li>
    <li>
      <a href="../articles/FacileAnalysis-examples.html">Reproducing genomic anlayses the facile way</a>
    </li>
    <li>
      <a href="../articles/FacileAnalysis-fdge.html">Facile Differential Expression Analysis</a>
    </li>
    <li>
      <a href="../articles/FacileAnalysis-fpca.html">Facile Principal Components Analysis</a>
    </li>
    <li>
      <a href="../articles/FacileAnalysis-fsea.html">Facile (Gene) Set Expression Analysis</a>
    </li>
  </ul>
</li>
      </ul>
      <ul class="nav navbar-nav navbar-right">
        <li>
  <a href="https://github.com/facilebio/FacileAnalysis/">
    <span class="fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
      
    </div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->

      

      </header>

<div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Runs a principal components analysis, the facile way.</h1>
    <small class="dont-index">Source: <a href='https://github.com/facilebio/FacileAnalysis/blob/master/R/fpca-compare.R'><code>R/fpca-compare.R</code></a>, <a href='https://github.com/facilebio/FacileAnalysis/blob/master/R/fpca.R'><code>R/fpca.R</code></a></small>
    <div class="hidden name"><code>fpca.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Performs a principal components analysis over a specified assay from the
(subset of) samples in a FacileDataStore.</p>
    </div>

    <pre class="usage"><span class='co'># S3 method for FacilePcaAnalysisResult</span>
<span class='fu'><a href='compare.html'>compare</a></span><span class='op'>(</span><span class='va'>x</span>, <span class='va'>y</span>, run_all <span class='op'>=</span> <span class='cn'>TRUE</span>, rerun <span class='op'>=</span> <span class='cn'>TRUE</span>, <span class='va'>...</span><span class='op'>)</span>

<span class='fu'>fpca</span><span class='op'>(</span>
  <span class='va'>x</span>,
  assay_name <span class='op'>=</span> <span class='cn'>NULL</span>,
  dims <span class='op'>=</span> <span class='fl'>5</span>,
  features <span class='op'>=</span> <span class='cn'>NULL</span>,
  filter <span class='op'>=</span> <span class='st'>"variance"</span>,
  ntop <span class='op'>=</span> <span class='fl'>1000</span>,
  row_covariates <span class='op'>=</span> <span class='cn'>NULL</span>,
  col_covariates <span class='op'>=</span> <span class='cn'>NULL</span>,
  batch <span class='op'>=</span> <span class='cn'>NULL</span>,
  main <span class='op'>=</span> <span class='cn'>NULL</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for facile_frame</span>
<span class='fu'>fpca</span><span class='op'>(</span>
  <span class='va'>x</span>,
  assay_name <span class='op'>=</span> <span class='cn'>NULL</span>,
  dims <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>nrow</a></span><span class='op'>(</span><span class='fu'><a href='https://dplyr.tidyverse.org/reference/compute.html'>collect</a></span><span class='op'>(</span><span class='va'>x</span>, n <span class='op'>=</span> <span class='cn'>Inf</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>1L</span><span class='op'>)</span>,
  features <span class='op'>=</span> <span class='cn'>NULL</span>,
  filter <span class='op'>=</span> <span class='st'>"variance"</span>,
  ntop <span class='op'>=</span> <span class='fl'>1000</span>,
  row_covariates <span class='op'>=</span> <span class='cn'>NULL</span>,
  col_covariates <span class='op'>=</span> <span class='cn'>NULL</span>,
  batch <span class='op'>=</span> <span class='cn'>NULL</span>,
  main <span class='op'>=</span> <span class='cn'>NULL</span>,
  custom_key <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Sys.getenv.html'>Sys.getenv</a></span><span class='op'>(</span><span class='st'>"USER"</span><span class='op'>)</span>,
  <span class='va'>...</span>
<span class='op'>)</span>

<span class='co'># S3 method for matrix</span>
<span class='fu'>fpca</span><span class='op'>(</span>
  <span class='va'>x</span>,
  dims <span class='op'>=</span> <span class='fu'><a href='https://rdrr.io/r/base/Extremes.html'>min</a></span><span class='op'>(</span><span class='fl'>5</span>, <span class='fu'><a href='https://rdrr.io/r/base/nrow.html'>ncol</a></span><span class='op'>(</span><span class='va'>x</span><span class='op'>)</span> <span class='op'>-</span> <span class='fl'>1L</span><span class='op'>)</span>,
  features <span class='op'>=</span> <span class='cn'>NULL</span>,
  filter <span class='op'>=</span> <span class='st'>"default"</span>,
  ntop <span class='op'>=</span> <span class='fl'>1000</span>,
  row_covariates <span class='op'>=</span> <span class='cn'>NULL</span>,
  col_covariates <span class='op'>=</span> <span class='cn'>NULL</span>,
  batch <span class='op'>=</span> <span class='cn'>NULL</span>,
  main <span class='op'>=</span> <span class='cn'>NULL</span>,
  use_irlba <span class='op'>=</span> <span class='va'>dims</span> <span class='op'>&lt;</span> <span class='fl'>7</span>,
  center <span class='op'>=</span> <span class='cn'>TRUE</span>,
  scale. <span class='op'>=</span> <span class='cn'>FALSE</span>,
  <span class='va'>...</span>
<span class='op'>)</span></pre>

    <h2 class="hasAnchor" id="arguments"><a class="anchor" href="#arguments"></a>Arguments</h2>
    <table class="ref-arguments">
    <colgroup><col class="name" /><col class="desc" /></colgroup>
    <tr>
      <th>x</th>
      <td><p>a facile data container (FacileDataSet), or a <code>facile_frame</code>
(refer to the FacileDataStore (facile_frame) section.</p></td>
    </tr>
    <tr>
      <th>rerun</th>
      <td><p>when <code>rerun = TRUE</code> (default), the <code>fpca(x)</code> and <code>fpca(y)</code> will
be rerun over the union of the features in <code>x</code> and <code>y</code>.</p></td>
    </tr>
    <tr>
      <th>assay_name</th>
      <td><p>the name of the assay to extract data from to perform the
PCA. If not specified, default assays are taken for each type of assay
container (ie. <code>default_assay(facile container)</code>, <code>"counts"</code> for a
<code>DGEList</code>, <code>assayNames(SummarizedExperiment)[1L]</code>, etc.)</p></td>
    </tr>
    <tr>
      <th>dims</th>
      <td><p>the number of PC's to calculate (minimum is 3).</p></td>
    </tr>
    <tr>
      <th>features</th>
      <td><p>A feature descriptor of the features to use for the analysis.
If <code>NULL</code> (default), then the specified <code>filter</code> strategy is used.</p></td>
    </tr>
    <tr>
      <th>filter</th>
      <td><p>A strategy used to identify which features to use for the
dimensionality reduction. The current (and only choice) is <code>"default"</code>,
which takes the <code>ntop</code> features, sorted be decreasing variance.</p></td>
    </tr>
    <tr>
      <th>ntop</th>
      <td><p>the number of features (genes) to include in the PCA. Genes are
ranked by decreasing variance across the samples in <code>x</code>.</p></td>
    </tr>
    <tr>
      <th>row_covariates, col_covariates</th>
      <td><p>data.frames that provie meta information
for the features (rows) and samples (columns). The default is to get
these values from "the obvious places" given <code>x</code> (<code>$genes</code> and <code>$samples</code>
for a DGEList, or the sample and feature-level covariate database tables
from a FacileDataSet, for example).</p></td>
    </tr>
    <tr>
      <th>batch, main</th>
      <td><p>specify the covariates to use for batch effect removal.
Refer to the <code><a href='https://rdrr.io/pkg/FacileData/man/remove_batch_effect.html'>FacileData::remove_batch_effect()</a></code> help for more information.</p></td>
    </tr>
    </table>

    <h2 class="hasAnchor" id="value"><a class="anchor" href="#value"></a>Value</h2>

    <p>an fpca result</p>
    <h2 class="hasAnchor" id="details"><a class="anchor" href="#details"></a>Details</h2>

    <p>The <code>FacilePcaAnalysisResult</code> produced here can be used in "the usual" ways,
ie. can be <code>viz</code>-ualized. <code><a href='viz.html'>shine()</a></code> is 1/4th-implemented, and <code><a href='viz.html'>report()</a></code>
has not been worked on yet.</p>
<p>Importantly / interestingly, you can shoot this result into <code><a href='ffsea.html'>ffsea()</a></code> to
perform gene set enrichment analysis over a specified dimension to identify
functional categories loaded onto differend PCs.</p>
    <h2 class="hasAnchor" id="comparing-pca-results"><a class="anchor" href="#comparing-pca-results"></a>Comparing PCA Results</h2>

    

<p>We can compare two PCA results. Currently this just means we compare the
loadings of the features along each PC from fpca result <code>x</code> and <code>y</code>.</p>
    <h2 class="hasAnchor" id="batch-correction"><a class="anchor" href="#batch-correction"></a>Batch Correction</h2>

    

<p>Because we assume that PCA is performed on normalized data, we leverage the
batch correction facilities provided by the <code>batch</code> and <code>main</code> parameters
in the <code><a href='https://rdrr.io/pkg/FacileData/man/fetch_assay_data.html'>FacileData::fetch_assay_data()</a></code> pipeline. If your samples have a
<code>"sex"</code> covariate defined, for example,  you can perform a PCA with
sex-corrected expression values like so: <code>fpca(samples, batch = "sex")</code></p>
    <h2 class="hasAnchor" id="features-used-for-pca"><a class="anchor" href="#features-used-for-pca"></a>Features Used for PCA</h2>

    

<p>By default, <code>fpca()</code> will assess the variance of all the features (genes) to
perform PCA over, and will keep the top <code>ntop</code> ones. This behavior is
determined by the following three parameters:</p><ol>
<li><p><code>filter</code> determines the method by which features are selected for
analysis. Currently you can only choose <code>"variance"</code> (the default) or
<code>"none"</code>.</p></li>
<li><p><code>features</code> determines the universe of features that are available for the
analysis. When <code>NULL</code> (default), all features for the given assay will
be loaded and filtered using the specification of the <code>filter</code> parameter.
If a feature descriptor is provided and <code>filter</code> is not specified, then
we assume that these are the exact features to run the analysis on, and
<code>filter</code> defaults to <code>"none"</code>. You may, however, intend for <code>features</code> to
define the universe of features to use prior to filtering, perhaps to
perform a PCA on only a certain set of genes (protein coding), but then
filter those further by variance. In this case, you will need to pass in
the feature descriptor for the universe of features you want to consider,
then <em>explicity set <code>filter = "variance"</code></em>.</p></li>
<li><p><code>ntop</code> the default "top" number of features to take when filtering by
variance.</p></li>
</ol>

    <h2 class="hasAnchor" id="development-notes"><a class="anchor" href="#development-notes"></a>Development Notes</h2>

    

<p>Follow progress on implementation of <code><a href='viz.html'>shine()</a></code> and <code><a href='viz.html'>report()</a></code> below:</p><ol>
<li><p><a href='https://github.com/facilebio/FacileAnalysis/issues/12'>Implement <code><a href='viz.html'>report()</a></code></a></p></li>
</ol>

<p>Note that there are methods defined for other assay containers, like an
<code><a href='https://rdrr.io/pkg/edgeR/man/DGEList.html'>edgeR::DGEList</a></code>, <code>limma::EList</code>, and <code>SummarizedExperiment</code>. If these are
called directly, their downstream use within the facile ecosystem isn't
yet fully supported. Development of the
<a href='https://github.com/facilebio/FacileBioc'>FacileBioc package</a>
will address this.</p>
    <h2 class="hasAnchor" id="random-things-to-elaborate-on"><a class="anchor" href="#random-things-to-elaborate-on"></a>Random Things to elaborate on</h2>

    

<p>The code here is largely inspired by DESeq2's plotPCA.</p>
<p>You should look at factominer:</p><ul>
<li><p>http://factominer.free.fr/factomethods/index.html</p></li>
<li><p>http://factominer.free.fr/graphs/factoshiny.html</p></li>
</ul>

    <h2 class="hasAnchor" id="teaching-and-tutorials"><a class="anchor" href="#teaching-and-tutorials"></a>Teaching and Tutorials</h2>

    


<p>This looks like a useful tutorial to use when explaining the utility of
PCA analysis:
http://alexhwilliams.info/itsneuronalblog/2016/03/27/pca/</p>
<p>High-Dimensional Data Analysis course by Rafa Irizarry and Michael Love
https://online-learning.harvard.edu/course/data-analysis-life-sciences-4-high-dimensional-data-analysis?category[]=84&amp;sort_by=date_added&amp;cost[]=free</p>
    <h2 class="hasAnchor" id="faciledatastore-facile-frame-"><a class="anchor" href="#faciledatastore-facile-frame-"></a>FacileDataStore (facile_frame)</h2>

    

<p>We enable the user to supply extra sample covariates that are not found
in the FacileDataStore associated with these samples <code>x</code> by adding them as
extra columns to <code>x</code>.</p>
<p>If manually provioded col_covariates have the same name as internal sample
covariates, then the manually provided ones will supersede the internals.</p>

    <h2 class="hasAnchor" id="examples"><a class="anchor" href="#examples"></a>Examples</h2>
    <pre class="examples"><div class='input'><span class='va'>efds</span> <span class='op'>&lt;-</span> <span class='fu'>FacileData</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/FacileData/man/exampleFacileDataSet.html'>exampleFacileDataSet</a></span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>p1</span> <span class='op'>&lt;-</span> <span class='va'>efds</span> <span class='op'>%&gt;%</span>
  <span class='fu'>FacileData</span><span class='fu'>::</span><span class='fu'>filter_samples</span><span class='op'>(</span><span class='va'>indication</span> <span class='op'>==</span> <span class='st'>"CRC"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>fpca</span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>p2</span> <span class='op'>&lt;-</span> <span class='va'>efds</span> <span class='op'>%&gt;%</span>
  <span class='fu'>FacileData</span><span class='fu'>::</span><span class='fu'>filter_samples</span><span class='op'>(</span><span class='va'>indication</span> <span class='op'>==</span> <span class='st'>"BLCA"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>fpca</span><span class='op'>(</span><span class='op'>)</span>
<span class='va'>pcmp</span> <span class='op'>&lt;-</span> <span class='fu'><a href='compare.html'>compare</a></span><span class='op'>(</span><span class='va'>p1</span>, <span class='va'>p2</span><span class='op'>)</span>
<span class='va'>efds</span> <span class='op'>&lt;-</span> <span class='fu'>FacileData</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/FacileData/man/exampleFacileDataSet.html'>exampleFacileDataSet</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='co'># A subset of samples ------------------------------------------------------</span>
<span class='va'>pca.crc</span> <span class='op'>&lt;-</span> <span class='va'>efds</span> <span class='op'>%&gt;%</span>
  <span class='fu'>FacileData</span><span class='fu'>::</span><span class='fu'>filter_samples</span><span class='op'>(</span><span class='va'>indication</span> <span class='op'>==</span> <span class='st'>"CRC"</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>fpca</span><span class='op'>(</span><span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='co'># report(pca.crc, color_aes = "sample_type")</span>
  <span class='fu'><a href='viz.html'>shine</a></span><span class='op'>(</span><span class='va'>pca.crc</span><span class='op'>)</span>
  <span class='fu'><a href='viz.html'>viz</a></span><span class='op'>(</span><span class='va'>pca.crc</span>, color_aes <span class='op'>=</span> <span class='st'>"sex"</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># Regress "sex" out from expression data</span>
<span class='va'>pca.crcs</span> <span class='op'>&lt;-</span> <span class='fu'>FacileData</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/FacileData/man/samples.html'>samples</a></span><span class='op'>(</span><span class='va'>pca.crc</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>fpca</span><span class='op'>(</span>batch <span class='op'>=</span> <span class='st'>"sex"</span><span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='viz.html'>viz</a></span><span class='op'>(</span><span class='va'>pca.crcs</span>, color_aes <span class='op'>=</span> <span class='st'>"sex"</span><span class='op'>)</span>
<span class='op'>}</span>

<span class='co'># Perform PCA on only the protein coding genes</span>
<span class='va'>genes.pc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/FacileData/man/features.html'>features</a></span><span class='op'>(</span><span class='va'>efds</span><span class='op'>)</span> <span class='op'>%&gt;%</span> <span class='fu'><a href='https://rdrr.io/r/base/subset.html'>subset</a></span><span class='op'>(</span><span class='va'>meta</span> <span class='op'>==</span> <span class='st'>"protein_coding"</span><span class='op'>)</span>
<span class='va'>pca.crc.pc</span> <span class='op'>&lt;-</span> <span class='fu'><a href='https://rdrr.io/pkg/FacileData/man/samples.html'>samples</a></span><span class='op'>(</span><span class='va'>pca.crc</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>fpca</span><span class='op'>(</span>features <span class='op'>=</span> <span class='va'>genes.pc</span>, filter <span class='op'>=</span> <span class='st'>"variance"</span><span class='op'>)</span>

<span class='va'>pca.gdb</span> <span class='op'>&lt;-</span> <span class='va'>pca.crc</span> <span class='op'>%&gt;%</span>
  <span class='fu'><a href='signature.html'>signature</a></span><span class='op'>(</span>dims <span class='op'>=</span> <span class='fl'>1</span><span class='op'>:</span><span class='fl'>3</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>result</span><span class='op'>(</span><span class='op'>)</span> <span class='op'>%&gt;%</span>
  <span class='fu'>sparrow</span><span class='fu'>::</span><span class='fu'><a href='https://rdrr.io/pkg/sparrow/man/GeneSetDb-class.html'>GeneSetDb</a></span><span class='op'>(</span><span class='op'>)</span>

<span class='co'># All samples --------------------------------------------------------------</span>
<span class='va'>pca.all</span> <span class='op'>&lt;-</span> <span class='fu'>fpca</span><span class='op'>(</span><span class='va'>efds</span><span class='op'>)</span>
<span class='kw'>if</span> <span class='op'>(</span><span class='fu'><a href='https://rdrr.io/r/base/interactive.html'>interactive</a></span><span class='op'>(</span><span class='op'>)</span><span class='op'>)</span> <span class='op'>{</span>
  <span class='fu'><a href='viz.html'>viz</a></span><span class='op'>(</span><span class='va'>pca.all</span>, color_aes <span class='op'>=</span> <span class='st'>"indication"</span>, shape_aes <span class='op'>=</span> <span class='st'>"sample_type"</span><span class='op'>)</span>
  <span class='co'># report(pca.all, color_aes = "indication", shape_aes = "sample_type")</span>
<span class='op'>}</span>
</div></pre>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top">
      <h2 data-toc-skip>Contents</h2>
    </nav>
  </div>
</div>


      <footer>
      <div class="copyright">
  <p>Developed by Steve Lianoglou, Denali Therapeutics.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.6.1.</p>
</div>

      </footer>
   </div>

  


  </body>
</html>


